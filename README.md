# Overview

Conditional independence tools for causal learning under the sparse mechanism shift hypothesis.

## Local installation

From a clean python environment (e.g. `conda create -n test python=3.9`),

```console
git clone https://github.com/rflperry/sparse_shift.git
cd sparse_shift
pip install -e .
```

## Running experiments and generating figures

First navigate and install necessary packages

```console
cd experiments
pip install -r requirements.txt
```

### Teaser figure

```console
cd experiments

python teaser_sparse_oracle_pc.py
```

Runs the teaser experiment and generates the figure.

### Simulations

```console
cd experiments/main_simulations
```

Then run the following commands for bivariate power:

```console
python run_experiment.py --experiment bivariate_power --quick
python run_experiment.py --experiment bivariate_multiplic_power --quick
```

Oracle rates:

```console
python run_experiment.py --experiment oracle_rates --quick
python run_experiment.py --experiment oracle_select_rates --quick
```

and empirical comparison simulations:

```console
python run_experiment.py --experiment pairwise_power --quick
```

Remove `--quick` and add `--n_jobs -2` to run the full paper experiments.
Note that this can take a long time.

The camera-ready figures can be generated by running

``console
python plot_bivariate_identifiability.py
python plot_oracle_rates.py
python plot_empirical_power.py
```

### Cytometry experiment

```console
cd experiments/cytometry
python run_cytometry_experiment.py --quick
```

Remove `--quick` and add `--n_jobs -2` to run the full paper experiments.
The camera-ready figure can be generated by running

```console
python analyze_pvalues.py
```
